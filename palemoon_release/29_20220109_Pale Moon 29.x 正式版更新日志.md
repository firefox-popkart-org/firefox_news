前注：[Pale Moon](https://www.palemoon.org/) 是 Firefox 的一个（最有实力的）旧版衍生，采用 Goanna 内核，并使用 XUL 进行界面布局。  
标 DiD（Defense-in-Depth）的要点，是预防针式的漏洞修复，避免以后可能出现的问题，[参考原文](https://www.palemoon.org/releasenotes.shtml)。

![palemoon_头图.jpg](https://s2.loli.net/2022/02/23/6aN4WKL5cOsSwxy.jpg)

## v29.4.4 (2022-01-18)

这是一次安全更新。

更新内容：

+ 提高了应用程序库加载的安全性（DiD）
+ 修复了 JavaScript 序列化的一个问题（DiD）
+ 修复了 IndexedDB 中潜在的越界问题（DiD）
+ 修复了小部件（？）数据处理代码中的潜在问题（DiD）
+ 修复了处理截断/损坏的传输流时可能被利用的崩溃问题
+ 修复了 DOM FileReader 代码中的一个问题
+ 将 NSS 更新至 3.52.3 以解决安全问题
+ 修复了以下安全问题：CVE-2022-22736, CVE-2022-22741, CVE-2021-4140, CVE-2022-22746, CVE-2022-22744 and CVE-2022-22747
+ 统一 XUL 平台 Mozilla 安全补丁概述：8个已修复，4个DiD，17个不适用

## v29.4.3 (2021-12-14)

这是一次安全更新，同时也增加一些额外功能。
此次更新重新支持了 FUEL，以保证旧扩展的兼容性，详情见实施日志。

更新内容：

+ 重新支持 FUEL abstraction library
+ 为计时器和文本片段添加额外的健全性检查（DiD）
+ 为程序线程逻辑添加了一个潜在的奔溃保护（DiD）
+ 修复了以下安全问题：CVE-2021-43537, CVE-2021-43541, CVE-2021-43536, CVE-2021-43545 and CVE-2021-43542
+ 统一 XUL 平台 Mozilla 安全补丁概述：已修复5个, 3个DiD, 10个不可用

实施日志：

+ 尽管于 29.4.0 和 29.4.2 版本被移除，也在 Pale Moon 内部废弃已久，FUEL 在经过社区的强烈反对和扩展兼容修复于事无补的情况下，又复活了。同时，这也是永久的复活，因为有些用户可能会离开，或停留在不安全的版本上——至于扩展的兼容性问题，似乎也没人来解决。在论坛上有关于此方向变化[更详细的公告](https://forum.palemoon.org/viewtopic.php?f=5&t=27682)

## v29.4.2.1 (2021-11-11)

此次更新修复一个小问题：自动完成的下拉列表的样式不正确，导致自定义主题出现问题或未按预期显示（如不可读的情况）。

## v29.4.2 (2021-11-09)

这是一次安全更新。

更新内容：

+ 修复了可能导致域名混淆的 IDN 规范遵从性问题
+ 修复了几个间歇性的线程健全性问题（DiD）
+ 修复了网络连接中可能出现的 UAF 风险（DiD）
+ 修复了潜在的奔溃风险（尚未暴露，DiD）
+ 修复了提交表单时潜在的被骗风险（CVE-2021-38508）
+ 通过 XSLT 修复了网页脚本沙盒逃逸的问题（CVE-2021-38503）
+ 添加了一个设置项以启用与早期 TLS 1.3 规范兼容的模式，详情见实施日志
+ 统一 XUL 平台 Mozilla 安全补丁概述：已修复3个，1个已应用，4个DiD，7个不可用

安全注意：如果已启用 HTTP Alternative Services for Opportunistic Encryption 功能，此时我们强烈建议禁用它：设置 -> 安全 -> Opportunistic Encryption -> Enable HTTP Alternative Services for Opportunistic Encryption。因为 http -> https 这种脆弱的传统处理办法已经被违背和滥用（partial opt-in bypass）。注意，由于这些既有风险，以及连接到服务器缺乏透明度的原因，我们默认将其禁用（包括其他任何 OE）。关于此问题的更多详情，可参阅 CVE-2021-38507。

实施日志：

+ 新增了一个设置项（security.ssl.enable_tls13_compat_mode），它允许用户启用兼容较旧协议规范草案的 TLS 1.3 模式。变更此设置项后，需要重启浏览器。注意，请只在必要时开启（如使用过时的代理软件、负载平衡器或中间件等情况），因为它可能会导致连接的安全性问题。
+ FUEL 已被移除（再次）。三个月前我们已经在 29.4.0 中将其移除（尽管之后临时恢复，以使扩展开发人员有更多时间解决问题），我们已经发出明确警告，使用 FUEL 的扩展将无法在此版本正常工作。

## v29.4.1 (2021-09-14)

这是一次安全更新。

更新内容：

+ 修复了潜在的崩溃问题（DiD）
+ 修复了 Internet Explorer 潜在的间接攻击问题（CVE-2021-38492）
+ 统一 XUL 平台 Mozilla 安全补丁概述：已修复1个，2个DiD，8个不可用

## v29.4.0.2 (2021-08-23)

这是一个微小的更新以解决 Linux 和 Windows 上音频停止工作的问题（尽管这很少出现）。我们仍在排查 Windows 上此问题的根本原因（Linux 方面的原因已经找到）。然而，此次更新，我们暂时恢复 audio library （libcubeb）到之前的版本，以便在此期间为用户提供适当的媒体体验。

## v29.4.0.1 (2021-08-18)

这是一个微小的更新以解决以下问题：  
在 29.4.0 版本，Pale Moon 已经移除了可选的 FUEL 组件（其在 Mozilla Add-On SDK 中早已被弃用）。这对许多流行的扩展及一些核心功能产生了意外的影响，而这些情况在我们发布前的测试和不稳定通道中并没有被注意到。  
作为我们解决问题，并履行承诺的一部分，我们为了扩展开发人员有更多的时间解决问题，此更新将【暂时】恢复 FUEL 组件。如果您是依赖 FUEL 组件或命名空间（如隐式“应用程序”）的扩展开发人员，请在下一个正式版前更新您的扩展。

## v29.4.0 (2021-08-17)

这是一个集新功能开发、bug 修复和安全更新的大版本。我们调整了发布时间表，以提供 web 兼容性的改进，而不仅仅作为本月的安全更新。

更新内容：

+ `promise.allSettled()` 方法已生效
+ 在 windows 和 workers 上实现了全局源
+ 改进了内存分配的性能
+ 将 libcubeb 更新为最新开发版，这提高了 OSS 的兼容性，同时解决了潜在的崩溃、性能和安全问题
+ 将 SQLite 更新至 3.36.0
+ 改进了 web 内容缓存线程的安全性（DiD）
+ 修复了一些潜在的崩溃和安全问题（DiD）
+ 统一 XUL 平台 Mozilla 安全补丁概述：5个DiD，12个不可用

## v29.3.0 (2021-07-19/20)

这是一个集新功能开发、bug 修复和安全更新的大版本。

更新内容：

+ 「Web 开发者」现在在菜单中被称为「开发者工具」
+ 更新并调整：主页、快速拨号，及登录页面样式
+ 在设置里做隐私标签内容的重新排布
+ 为支持的站点启用基于 http 的 brotli 压缩，详见实施说明
+ 实现了 `EventTarget` 构造器
+ 更新了 Windows 10 工具箱样式（窗口样式？）
+ 更新了端口黑名单（移除 10080 端口），详见实施说明
+ CSS：实现了 `calc()` 方法，对 `stroke-dashoffset` 启用动画支持
+ 添加了 chrome CSS 样式表的布尔选项支持，以实现更高级的主题配置
+ 添加了 CSS 动态深色主题的支持
+ 根据最新规范变更了 `ResizeObserver` 的具体实现，详见实施说明
+ 删除了一大堆 Macintosh 相关代码
+ 从布局引擎中移除了过时的系统主题支持
+ 修复了数个崩溃问题
+ Linux：移除了早已过时的 Mesa/Nouveau 驱动，因为它可能导致一些问题
+ 解决了一些安全问题：包括 CVE-2021-30547 及数个没有 CVE 编号的问题
+ 统一 XUL 平台 Mozilla 安全补丁概述：3个已修复，3个DiD，2个推迟（DiD），12个不可用

实施说明：

+ Brotli 压缩算法（数年前引入）最初仅用于在 web 浏览器中使用 https，因为担心其与设计不佳的中间件盒子进行交互，并试图显式重新压缩数据，然而其无法识别新的压缩流类型，甚至出错。而这些框中进行的处理（SDCH）早已被弃用。在此之后，Chrome 及 Firefox 一直保持 http 和 https 之间对 Brotli 的隔离，通过人为地降低 http 的效率（拒绝使用更密集的 Brotli 压缩），进一步推广 https 而非 http。由于没有任何技术缘由不启用 http 上的 Brotli，于是我们将从此版本开始接受纯 http 上的 Brotli（通过接受编码），当服务器也启用它时，带宽使用量将减少20%。
+ 我们维护一个不应从浏览器寻址的端口黑名单（以防止脚本滥用）。前段时间，我们更新了更大范围的端口号，其中就包括端口 10080（Amanda）。然而，很多其他公共服务/设备也使用这个端口（比如随机到它），所以我们再次从黑名单中移除了此端口。
+ `ResizeObserver` 的实现已更改为现存 API 的更新规范，包括实验属性 `contentBoxSize` 和 `borderBoxSize`，将允许更精细的控件响应和元素大小的更改。为了保证 web 的兼容性，陈旧的 `contentRect` 大小属性依然支持。

## v29.2.1 (2021-06-08)

这是一个小小的错误修正版本~

更新内容：

+ 解决了自动完成偶尔不弹出窗口的问题（同时添加一些调试日志，以便找到根源）
+ 修正了鼠标滚动 DOM 抛出错误的问题
+ 修正了从睡眠状态恢复时，网络发现程序无法正确启动的问题
+ 修正了通过 DOM 大量上传文件时的崩溃问题
+ 修正了可编辑菜单列表按钮在 GTK3 上不可见的问题
+ 减少了错误日志中「重要配置项」的数量，比如单个打印机的属性信息
+ 修复了 JS JIT 编译器不跟踪 debug 环境的问题（DiD）

此版本没有添加 UXP 和 Pale Moon 的安全补丁。

## v29.2.0 (2021-04-27)

这是一个面向开发者和错误修复的版本。  
以此开端，我们将不再支持没有直接针对 Pale Moon 更新而无人维护的 Firefox 旧扩展（正式分道扬镳），[详情见此](https://forum.palemoon.org/viewtopic.php?f=1&t=26657)。

更新内容：

+ 从历史侧边栏新开标签时，如果一次打开过多标签页，Pale Moon 会弹出警告
+ 为了用户界面的一致性，Pale Moon 现在书签文件夹添加了「全部打开」的菜单项，即使其中只有一个项目
+ 在设置里添加了媒体格式控制的分类
+ 添加了明亮/黑暗的默认配色方案选项，详见实施说明
+ 兼容性问题，将对几个特定站点进行 UA 覆盖（万恶的 Chrome。。）
+ 移除了接受 Firefox IDs 以安装扩展的能力
+ 移除了可以移除的 Macintosh 前端代码
+ 将 AV1 依赖库更新至 2.0 版本
+ 清除了平台上的一些 Android 代码
+ 更新了字体，以适配多种族多职业的 emoji 显示
+ 修复了剪贴板的溢出问题，它们可能被错误地渲染
+ 已添加 `smooth`，`high-quality` 以及 `pixelated` 的值进 CSS 属性 `image-rendering`
+ 接轨标准，`Intl.NumberFormat.formatToParts()` 将允许脚本对本地化数字格式进行解构
+ 恢复了 `dom.details_element.enabled` 配置项，并修复 summary / details 的 html 元素渲染问题
+ 修正了 CSP 一个 `.nonce` 元素属性的问题
+ 解决了两个安全问题：CVE-2021-29946（DiD）以及 CVE-2021-23994（DiD）
+ 统一 XUL 平台 Mozilla 安全补丁概述：2个DiD，14个不可用

实施说明:

此版本增加了 `prefers-color-scheme` CSS 属性的支持，该属性告诉站点使用明亮还是黑暗的配色方案。  
对于其他浏览器，这将与系统配色直接相关并自动应用（这可能会留足迹，存在隐私问题），所以我们决定通过「设置-内容-颜色」给予用户选择的权利（所有人默认明亮）。

尽管我们也提供了禁用此功能并直接不支持此属性的选项，但注意，这可能会在一些不配置默认配色方案的站点上出现问题，未来我们可能会添加一个类似其他浏览器的「自动」选项，以防系统和网页配色不同带来的割裂感。